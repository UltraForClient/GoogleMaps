<!Doctype html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">

    <title>Magazyn mapa</title>

    <link rel="stylesheet" href="css/style.css" type="text/css" media="screen">
    <link rel="stylesheet" href="css/print.css" type="text/css" media="print">
    <link type="text/css" href="css/ui-lightness/jquery-ui-1.8.16.custom.css" rel="stylesheet"/>
</head>

<body>
<div id="fb-root"></div>
<h2>OptiMap - Fastest Roundtrip Solver</h2>
<table class='mainTable'>
    <tr>
        <td class='left' style='vertical-align: top'>
            <div id="leftPanel">
                <button class="add-point" data-toggle="false">Dodaj punkt zaznaczając na mapie</button>
                    <div>
                        <label for="addressStr">Add Location by Address:</label>
                        <input name="addressStr" id="addressStr" type="text">
                        <button onclick="addAddress(addressStr.value)">Add!</button>
                    </div>

                    <div>
                        <h3>Zmień kolejność</h3>
                        <div id="routeDrag"></div>
                        <div id="reverseRoute"></div>
                    </div>
                </div>

            <button id="button1" class="calc-button">Oblicz najszybszą trase do okoła</button>
            <button id="button2" class="calc-button">Oblicz najszybszą trasę od pierwszego punktu do ostatniego</button>
            <button id='button3' class="calc-button">Wyczyść mape</button>
        </td>
        <td class='right' style='vertical-align: top'>
            <div id="map" class="myMap"></div>
        </td>
    </tr>
</table>

<!-- Hidden stuff -->
<div id="bulkLoader_hidden" style="visibility: hidden;">
    <form name="listOfLocations" onSubmit="clickedAddList(); return false;">
        <textarea name="inputList" rows="10" cols="70">One destination per line</textarea><br>
        <input type="button" value="Add list of locations" onClick="clickedAddList()">
    </form>
</div>
<div id="exportData_hidden" style="visibility: hidden;"></div>
<div id="exportLabelData_hidden" style="visibility: hidden;"></div>
<div id="exportAddrData_hidden" style="visibility: hidden;"></div>
<div id="exportOrderData_hidden" style="visibility: hidden;"></div>
<div id="durationsData_hidden" style="visibility: hidden;"></div>

<div id="dialogProgress" title="Calculating route...">
    <div id="progressBar"></div>
</div>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
<script type="application/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript" src="js/BpTspSolver.js"></script>
<script type="text/javascript" src="js/directions-export.js"></script>
<script type="text/javascript" src="js/tsp.js"></script>

<script type="text/javascript">
    jQuery.noConflict();

    loadAtStart(50, 20, 6);

    const actionButtons = document.querySelectorAll('.calc-button');

    actionButtons.forEach(actionButton => {
        actionButton.addEventListener('click', e => {
            switch (e.target.id) {
                case 'button1':
                    directions(0);
                    break;
                case 'button2':
                    directions(1);
                    break;
                case 'button3':
                    startOver();
                    break;
            }
        })
    });

    jQuery(function () {
        jQuery("#accordion").accordion({
            collapsible: true,
            autoHeight: false,
            clearStyle: true
        });
        jQuery("input:button").button();
        jQuery("#dialogProgress").dialog({
            height: 140,
            modal: true,
            autoOpen: false
        });
        jQuery("#progressBar").progressbar({value: 0});
        jQuery("#dialogTomTom").dialog({
            height: 480,
            width: 640,
            modal: true,
            autoOpen: false
        });
        jQuery("#dialogGarmin").dialog({
            height: 480,
            width: 640,
            modal: true,
            autoOpen: false
        });
        jQuery('.myMap').height(jQuery(window).height() - 100);
    });

    // (function () {
    //     var po = document.createElement('script');
    //     po.type = 'text/javascript';
    //     po.async = true;
    //     po.src = 'https://apis.google.com/js/plusone.js';
    //     var s = document.getElementsByTagName('script')[0];
    //     s.parentNode.insertBefore(po, s);
    // })();

</script>

<script>
    google.maps.event.addListener(map, 'click', event => {
        const lat = event.latLng.lat();
        const lng = event.latLng.lng();
        addAddress(lat + ', ' + lng)
    });
</script>
</body>
</html>
